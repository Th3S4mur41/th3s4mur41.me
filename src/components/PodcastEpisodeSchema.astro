---
import StructuredData from "./StructuredData.astro";

interface Props {
	name: string;
	description?: string;
	datePublished: Date;
	url: string;
	canonical?: string;
	publisherName?: string;
	publisherUrl?: string;
	image?: {
		src: string;
		attributes?: {
			width?: number;
			height?: number;
		};
	};
	authorName?: string;
	siteName?: string;
}

const {
	name,
	description,
	datePublished,
	url,
	canonical,
	publisherName,
	publisherUrl,
	image,
	authorName = "MichaÃ«l Vanderheyden",
	siteName = "Th3S4mur41.me",
} = Astro.props;

const origin = Astro.url.origin;
const absolute = (maybeUrl: string) => new URL(maybeUrl, origin).href;

const jsonLd = {
	"@context": "https://schema.org",
	"@type": "PodcastEpisode",
	name,
	description,
	datePublished: datePublished.toISOString(),
	url,
	...(canonical ? { isBasedOn: canonical } : {}),
	...(image?.src
		? {
				image: {
					"@type": "ImageObject",
					url: absolute(image.src),
					...(image.attributes?.width ? { width: image.attributes.width } : {}),
					...(image.attributes?.height ? { height: image.attributes.height } : {}),
				},
			}
		: {}),
	publisher: {
		"@type": "Organization",
		name: publisherName ?? siteName,
		url: publisherUrl ? absolute(publisherUrl) : absolute("/"),
	},
	creator: {
		"@type": "Person",
		name: authorName,
		url: absolute("/about/"),
	},
	inLanguage: "en",
};
---

<StructuredData data={jsonLd} />
