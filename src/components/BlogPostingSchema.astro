---
import profileImage from "/src/assets/michael-profile-2022-katana.png";
import StructuredData from "./StructuredData.astro";

interface Props {
	headline: string;
	description?: string;
	datePublished: Date;
	dateModified?: Date;
	image?: {
		src: string;
		attributes?: {
			width?: number;
			height?: number;
		};
	};
	url: string;
	canonical?: string;
}

const { headline, description, datePublished, dateModified, image, url, canonical } = Astro.props;

const origin = Astro.url.origin;
const absolute = (maybeUrl: string) => new URL(maybeUrl, origin).href;
const authorImageUrl = new URL(profileImage.src, origin).href;

const personData = {
	"@type": "Person",
	"@id": "https://th3s4mur41.me/#person",
	name: "Michaël Vanderheyden",
	alternateName: "Th3S4mur41",
	url: "https://th3s4mur41.me/",
	image: authorImageUrl,
	sameAs: [
		"https://www.linkedin.com/in/michaelvanderheyden/",
		"https://bsky.app/profile/th3s4mur41.me",
		"https://github.com/Th3S4mur41",
		"https://codepen.io/th3s4mur41/",
		"https://th3s4mur41.medium.com/",
		"https://www.instagram.com/th3s4mur41/",
		"https://twitter.com/Th3S4mur41",
		"https://fosstodon.org/@Th3S4mur41",
	],
};

const websiteData = {
	"@type": "WebSite",
	"@id": "https://th3s4mur41.me/#website",
	url: "https://th3s4mur41.me/",
	name: "Th3S4mur41",
	description:
		"Personal website and blog of Michaël Vanderheyden - Web developer passionate about accessibility, modern web standards, and user-friendly interfaces",
	image: "https://th3s4mur41.me/icons/favicon-512.png",
	publisher: {
		"@id": "https://th3s4mur41.me/#person",
	},
};

const blogPostingData = {
	"@type": "BlogPosting",
	"@id": url,
	headline,
	description,
	datePublished: datePublished.toISOString(),
	...(dateModified ? { dateModified: dateModified.toISOString() } : {}),
	mainEntityOfPage: {
		"@type": "WebPage",
		"@id": url,
	},
	url,
	...(canonical ? { isBasedOn: canonical } : {}),
	...(image?.src
		? {
				image: {
					"@type": "ImageObject",
					url: absolute(image.src),
					...(image.attributes?.width ? { width: image.attributes.width } : {}),
					...(image.attributes?.height ? { height: image.attributes.height } : {}),
				},
			}
		: {}),
	author: {
		"@id": "https://th3s4mur41.me/#person",
	},
	publisher: {
		"@id": "https://th3s4mur41.me/#website",
	},
	isPartOf: {
		"@id": "https://th3s4mur41.me/#website",
	},
	inLanguage: "en",
};

const jsonLd = {
	"@context": "https://schema.org",
	"@type": "WebPage",
	"@id": url,
	"@graph": [websiteData, personData, blogPostingData],
};
---

<StructuredData data={jsonLd} />
